const bigCategory = [
    {
        src: 'images/waste-recycling/wr1_1.png',
        cate: '大家电',
        subCate: [
            // '激光打印机',
            '监视器',
            '传真机',
            '复印机',
            '电话单机',
            '燃气热水器',
            '针式打印机',
            '电热水器',
            '吸油烟机',
            '针式打印机',
            '喷墨打印机',
            '吸油烟机',
        ],
    },
    {
        src: 'images/waste-recycling/wr1_2.png',
        cate: '小家电',
        subCate: [
            '针式打印机',
            '监视器',
            '激光打印机',
            '吸油烟机',
            '电话单机',
            // '燃气热水器',
            '传真机',
            // '喷墨打印机',
            '吸油烟机',
            '电热水器',
            '复印机',
            '针式打印机',
        ],
    },
    {
        src: 'images/waste-recycling/wr1_3.png',
        cate: '手机',
        subCate: [
            '喷墨打印机',
            '激光打印机',
            '吸油烟机',
            '针式打印机',
            '复印机',
            '电话单机',
            '传真机',
            '监视器',
            '吸油烟机',
            '燃气热水器',
            '针式打印机',
            '电热水器',
        ],
    },
    {
        src: 'images/waste-recycling/wr1_4.png',
        cate: '废电池',
        subCate: [
            '复印机',
            '监视器',
            '传真机',
            '激光打印机',
            '吸油烟机',
            '喷墨打印机',
            '针式打印机',
            '燃气热水器',
            '电热水器',
            '电话单机',
            '吸油烟机',
            '针式打印机',
        ],
    },
    {
        src: 'images/waste-recycling/wr1_5.png',
        cate: '废灯管',
        subCate: [
            '激光打印机',
            '复印机',
            '燃气热水器',
            '喷墨打印机',
            '电话单机',
            '传真机',
            '电热水器',
            '针式打印机',
            '监视器',
            '吸油烟机',
            '针式打印机',
            '吸油烟机',
        ],
    },
    {
        src: 'images/waste-recycling/wr1_6.png',
        cate: '废纸',
        subCate: [
            '吸油烟机',
            '复印机',
            '监视器',
            '传真机',
            '针式打印机',
            '针式打印机',
            '激光打印机',
            '喷墨打印机',
            '电话单机',
            '吸油烟机',
            '电热水器',
            '燃气热水器',
        ],
    },
    {
        src: 'images/waste-recycling/wr1_7.png',
        cate: '废塑料',
        subCate: [
            '传真机',
            '复印机',
            '燃气热水器',
            '喷墨打印机',
            '激光打印机',
            '电热水器',
            '吸油烟机',
            '针式打印机',
            '监视器',
            '电话单机',
            '针式打印机',
            '吸油烟机',
        ],
    },
    {
        src: 'images/waste-recycling/wr1_8.png',
        cate: '废铜烂铁',
        subCate: [
            '监视器',
            '激光打印机',
            '电话单机',
            '吸油烟机',
            '燃气热水器',
            '复印机',
            '吸油烟机',
            '电热水器',
            '针式打印机',
            '针式打印机',
            '传真机',
            '喷墨打印机',
        ],
    },
    {
        src: 'images/waste-recycling/wr1_9.png',
        cate: '报废汽车',
        subCate: [
            '燃气热水器',
            '电话单机',
            '传真机',
            '喷墨打印机',
            '吸油烟机',
            '针式打印机',
            '吸油烟机',
            '电热水器',
            '针式打印机',
            '激光打印机',
            '监视器',
            '复印机',
        ],
    },
    {
        src: 'images/waste-recycling/wr1_10.png',
        cate: '其它废车',
        subCate: [
            '复印机',
            '传真机',
            '针式打印机',
            '针式打印机',
            '燃气热水器',
            '吸油烟机',
            '电话单机',
            '喷墨打印机',
            '电热水器',
            '吸油烟机',
            '监视器',
            '激光打印机',
        ],
    },
    {
        src: 'images/waste-recycling/wr1_11.png',
        cate: '厨房五金',
        subCate: [
            '电热水器',
            '传真机',
            '针式打印机',
            '吸油烟机',
            '喷墨打印机',
            '燃气热水器',
            '激光打印机',
            '吸油烟机',
            '复印机',
            '监视器',
            '针式打印机',
            '电话单机',
        ],
    },
    {
        src: 'images/waste-recycling/wr1_12.png',
        cate: '其它',
        subCate: [
            '复印机',
            '吸油烟机',
            '燃气热水器',
            '针式打印机',
            '吸油烟机',
            '激光打印机',
            '针式打印机',
            '监视器',
            '电话单机',
            '喷墨打印机',
            '传真机',
            '电热水器',
        ],
    },
];

const smallCategory = {
    传真机: 'images/waste-recycling/wr2_1.png',
    电话单机: 'images/waste-recycling/wr2_2.png',
    电热水器: 'images/waste-recycling/wr2_3.png',
    复印机: 'images/waste-recycling/wr2_4.png',
    激光打印机: 'images/waste-recycling/wr2_5.png',
    监视器: 'images/waste-recycling/wr2_6.png',
    喷墨打印机: 'images/waste-recycling/wr2_7.png',
    燃气热水器: 'images/waste-recycling/wr2_8.png',
    吸油烟机: 'images/waste-recycling/wr2_11.png',
    针式打印机: 'images/waste-recycling/wr2_12.png',
};

var pointMall = [
    { index: 0, price: 10.0, name: '防滑隔热垫', point: 100, src: 'images/waste-recycling/wr3_1.jpg' },
    { index: 1, price: 25.0, name: '城市果园盆栽', point: 250, src: 'images/waste-recycling/wr3_2.jpg' },
    { index: 2, price: 25.0, name: '康乐欧式纸巾盒', point: 100, src: 'images/waste-recycling/wr3_3.jpg' },
    { index: 3, price: 30.0, name: '迷你风扇', point: 350, src: 'images/waste-recycling/wr3_4.jpg' },
    { index: 4, price: 40.0, name: '咪咪熊煮蛋器', point: 400, src: 'images/waste-recycling/wr3_5.jpg' },
    { index: 5, price: 60.0, name: '花篮加湿器', point: 600, src: 'images/waste-recycling/wr3_6.jpg' },
    { index: 6, price: 70.0, name: '盆栽太阳能灯', point: 700, src: 'images/waste-recycling/wr3_7.jpg' },
    { index: 7, price: 149.0, name: '金刚音响', point: 1490, src: 'images/waste-recycling/wr3_8.jpg' },
    { index: 8, price: 149.0, name: '多功能电蒸锅', point: 1490, src: 'images/waste-recycling/wr3_9.jpg' },
    { index: 9, price: 169.0, name: '零碳台灯', point: 1690, src: 'images/waste-recycling/wr3_10.jpg' },
];

function shuffle(a) {
    var len = a.length;
    for (var i = 0; i < len; i++) {
        var end = len - 1;
        var index = (Math.random() * (end + 1)) >> 0;
        var t = a[end];
        a[end] = a[index];
        a[index] = t;
    }
    return a;
}

function inputFocus() {
    $('.input-effect').addClass('actived');
}
function inputBlur() {
    $('.input-effect').removeClass('actived');
}

function setKeyword(kwd) {
    $('#keyword').val(kwd);
}

function cateMouseEnter(e) {
    var t = $(e.currentTarget);
    var cate = t.attr('cate');
    $('.category-item[cate="' + cate + '"]').removeClass('actived');
    t.addClass('actived');

    if (cate == 'big') {
        switchCategory(parseInt(t.attr('index')));
    }
}

function init() {
    var cb = $('#cate-big');
    for (var i in bigCategory) {
        var e = bigCategory[i];

        var fbox = $('<div>');
        fbox.addClass('category-item');
        fbox.attr('cate', 'big');
        fbox.attr('index', i);
        fbox.mouseenter(cateMouseEnter);

        var imgb = $('<img>');
        imgb.attr('src', e.src);
        imgb.appendTo(fbox);

        var innerdiv = $('<div>');
        innerdiv.text(e.cate);
        innerdiv.appendTo(fbox);

        fbox.appendTo(cb);
    }
    $('.category-item[cate="big"]')[0].className = 'category-item actived';

    switchCategory(0);

    shuffle(pointMall);
    var pm = $('#point-mall');
    for (var e of pointMall) {
        var fbox = $('<div>');
        fbox.addClass('point-goods-item');
        fbox.attr('gid', e.index);
        fbox.click((e) => {
            var t = $(e.currentTarget);
            window.open('/item.html?gid=' + t.attr('gid'));
        });

        var ubox = $('<div>');
        ubox.appendTo(fbox);

        var imgb = $('<img>');
        imgb.attr('src', e.src);
        imgb.appendTo(ubox);

        var dbox = $('<div>');
        dbox.addClass('goods-info');
        dbox.appendTo(fbox);

        var divp = $('<div>');
        divp.addClass('goods-price');
        divp.text('市场价格：￥' + e.price.toFixed(2));
        divp.appendTo(dbox);

        var divn = $('<div>');
        divn.addClass('goods-name');
        divn.text(e.name);
        divn.appendTo(dbox);

        var divp = $('<div>');
        divp.addClass('goods-point');
        divp.html('兑换所需积分：<span>' + e.point.toString() + '</span>');
        divp.appendTo(dbox);

        fbox.appendTo(pm);
    }
}

init();

function switchCategory(index) {
    var cs = $('#cate-small');
    cs.html('');

    for (var i in bigCategory[index].subCate) {
        var e = bigCategory[index].subCate[i];

        var fbox = $('<div>');
        fbox.addClass('category-item');
        fbox.attr('cate', 'small');
        fbox.attr('index', i);
        fbox.mouseenter(cateMouseEnter);

        var imgb = $('<img>');
        imgb.attr('src', smallCategory[e]);
        imgb.appendTo(fbox);

        var innerdiv = $('<div>');
        innerdiv.text(e);
        innerdiv.appendTo(fbox);

        fbox.appendTo(cs);
    }
    $('.category-item[cate="small"]')[0].className = 'category-item actived';
}
